# Exploiting an SSRF Vulnerability. Recently, I had the opportunity to… | by Charlie T. | Jan, 2023 | System Weakness
![](https://miro.medium.com/max/1400/1*IoE53Y7K3cixZdhmikH7hA.png)

Recently, I had the opportunity to engage with a CTF machine that involved compromising a web server hosting a web application that had a Server-Side Request Forgery (SSRF) vulnerability. In this blog post, I will explain how I was able to exploit this vulnerability and gain access and establish a foothold.

First, let’s define what SSRF is. SSRF is a type of vulnerability that allows an attacker to send a maliciously crafted request from the vulnerable server to a different server on the network. This can be used to access internal resources that are not normally accessible from the internet, such as a local file system or a database.

In this machine, the web application had a functionality that allowed users to submit URLs to be checked for their availability. However, the application did not properly validate the URLs, which allowed me to submit a URL that would trigger an SSRF vulnerability.

Here is a step-by-step guide on how I was able to exploit this vulnerability:

*   Identify the vulnerability: I discovered the SSRF vulnerability by manually testing a `path` parameter in the URL and submitting various URLs to it as arguments.
*   To be sure that it was SSRF and not just RFI (Remote File Inclusion), we passed [http://localhost](http://localhost/):60000/, which we know is open on this host. We were successful and confirmed SSRF. Here is a proof of concept with an external resource:

![](https://miro.medium.com/max/1400/1*pCp6_e1d5gDTyQ9SEWXtog.png)

*   Discovering local ports by fuzzing: After confirming that we have an SSRF vulnerability, we were able to scan for ports that are open locally which would lead to further enumeration and possible sensitive data exposure. We used a tool called wfuzz:

```
$ wfuzz -c -w /path/ports.txt -u 'http://$IP/url.php?path=http://localhost:FUZZ'

=====================================================================  
ID           Response   Lines    Word       Chars       Payload  
=====================================================================

000000022:   200        4 L      4 W        62 Ch       "22"  
000000090:   200        11 L     18 W       156 Ch      "90"  
000000110:   200        17 L     24 W       187 Ch      "110"  
000000200:   200        3 L      2 W        22 Ch       "200"  
000000320:   200        26 L     109 W      1232 Ch     "320"  
000000888:   200        78 L     265 W      3955 Ch     "888"  
000003306:   200        2 L      6 W        123 Ch      "3306"  
000008080:   200        2 L      47 W       994 Ch      "8080"


```

*   Capture the response: After going through each port and using Burp Suite to capture the responses, we discovered that port 888 had plain-text credentials for an `Admin` user.

![](https://miro.medium.com/max/1400/1*5UmHp9rSF6rdD3fuZDayKA.png)

*   Leverage the vulnerability: Using the information I captured, I was able to leverage the SSRF vulnerability to access other internal resources and ultimately gain access to the machine.

I hope this guide provides a clear understanding of how SSRF vulnerabilities can be exploited, and how to identify, enumerate further and leverage the vulnerability. Keep in mind that this is a simplified version and in a real scenario, the process would be more complex and have more steps.

SSRF vulnerabilities are very dangerous and should be addressed as soon as they are discovered. Developers should validate all user input to ensure that it is safe and implement security measures such as a Web Application Firewall (WAF) to protect against SSRF attacks.